<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pops-core: pops::Simulation&lt; IntegerRaster, FloatRaster, RasterIndex &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pops-core
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">PoPS (Pest or Pathogen Spread) Model Core C++ library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepops.html">pops</a></li><li class="navelem"><a class="el" href="classpops_1_1Simulation.html">Simulation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpops_1_1Simulation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pops::Simulation&lt; IntegerRaster, FloatRaster, RasterIndex &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The main class to control the spread simulation.  
 <a href="classpops_1_1Simulation.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a72d91f035b337f83baad33060668503a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a72d91f035b337f83baad33060668503a">Simulation</a> (unsigned random_seed, RasterIndex rows, RasterIndex cols, <a class="el" href="namespacepops.html#adebccffc3c90801a4d306c1a43c5ac20">ModelType</a> model_type=<a class="el" href="namespacepops.html#adebccffc3c90801a4d306c1a43c5ac20af0788f6fa2be9b0969507a4424b0c91c">ModelType::SusceptibleInfected</a>, unsigned latency_period=0, bool dispersers_stochasticity=true, bool establishment_stochasticity=true, bool movement_stochasticity=true)</td></tr>
<tr class="memdesc:a72d91f035b337f83baad33060668503a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates simulation object and seeds the internal random number generator.  <a href="classpops_1_1Simulation.html#a72d91f035b337f83baad33060668503a">More...</a><br /></td></tr>
<tr class="separator:a72d91f035b337f83baad33060668503a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bc14a9f3e393edc560e78586761e23"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a84bc14a9f3e393edc560e78586761e23">Simulation</a> ()=delete</td></tr>
<tr class="separator:a84bc14a9f3e393edc560e78586761e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad060e789f6c3260f4e96f9a14c0caad8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#ad060e789f6c3260f4e96f9a14c0caad8">remove</a> (IntegerRaster &amp;infected, IntegerRaster &amp;susceptible, const FloatRaster &amp;temperature, double lethal_temperature, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells)</td></tr>
<tr class="memdesc:ad060e789f6c3260f4e96f9a14c0caad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">removes infected based on min or max temperature tolerance  <a href="classpops_1_1Simulation.html#ad060e789f6c3260f4e96f9a14c0caad8">More...</a><br /></td></tr>
<tr class="separator:ad060e789f6c3260f4e96f9a14c0caad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c4f2e4d644adcae3e7aa2d5b2739367"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a9c4f2e4d644adcae3e7aa2d5b2739367">mortality</a> (IntegerRaster &amp;infected, IntegerRaster &amp;total_hosts, double mortality_rate, int mortality_time_lag, IntegerRaster &amp;died, std::vector&lt; IntegerRaster &gt; &amp;mortality_tracker_vector, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells)</td></tr>
<tr class="memdesc:a9c4f2e4d644adcae3e7aa2d5b2739367"><td class="mdescLeft">&#160;</td><td class="mdescRight">kills infected hosts based on mortality rate and timing.  <a href="classpops_1_1Simulation.html#a9c4f2e4d644adcae3e7aa2d5b2739367">More...</a><br /></td></tr>
<tr class="separator:a9c4f2e4d644adcae3e7aa2d5b2739367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1770a130586e638e6b2d4aa85ae0b3cd"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a1770a130586e638e6b2d4aa85ae0b3cd">movement</a> (IntegerRaster &amp;infected, IntegerRaster &amp;susceptible, std::vector&lt; IntegerRaster &gt; &amp;mortality_tracker_vector, std::vector&lt; IntegerRaster &gt; &amp;exposed, IntegerRaster &amp;resistant, IntegerRaster &amp;total_hosts, IntegerRaster &amp;total_exposed, unsigned step, unsigned last_index, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;movements, std::vector&lt; unsigned &gt; movement_schedule, std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells)</td></tr>
<tr class="memdesc:a1770a130586e638e6b2d4aa85ae0b3cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves hosts from one location to another.  <a href="classpops_1_1Simulation.html#a1770a130586e638e6b2d4aa85ae0b3cd">More...</a><br /></td></tr>
<tr class="separator:a1770a130586e638e6b2d4aa85ae0b3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83fb3fbcb9ad981708d04e4d9ae12e7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a83fb3fbcb9ad981708d04e4d9ae12e7b">generate</a> (IntegerRaster &amp;dispersers, const IntegerRaster &amp;infected, bool weather, const FloatRaster &amp;weather_coefficient, double reproductive_rate, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells)</td></tr>
<tr class="memdesc:a83fb3fbcb9ad981708d04e4d9ae12e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates dispersers based on infected.  <a href="classpops_1_1Simulation.html#a83fb3fbcb9ad981708d04e4d9ae12e7b">More...</a><br /></td></tr>
<tr class="separator:a83fb3fbcb9ad981708d04e4d9ae12e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404a1a676a9b88fda61c8a7f5834bf85"><td class="memTemplParams" colspan="2">template&lt;typename DispersalKernel &gt; </td></tr>
<tr class="memitem:a404a1a676a9b88fda61c8a7f5834bf85"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85">disperse</a> (const IntegerRaster &amp;dispersers, IntegerRaster &amp;susceptible, IntegerRaster &amp;exposed_or_infected, IntegerRaster &amp;mortality_tracker, const IntegerRaster &amp;total_populations, IntegerRaster &amp;total_exposed, std::vector&lt; std::tuple&lt; int, int &gt;&gt; &amp;outside_dispersers, bool weather, const FloatRaster &amp;weather_coefficient, <a class="el" href="namespacepops.html#a12d03d2282e4fab7a1e0e8040a022c40">DispersalKernel</a> &amp;dispersal_kernel, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells, double establishment_probability=0.5)</td></tr>
<tr class="memdesc:a404a1a676a9b88fda61c8a7f5834bf85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates dispersal locations for the dispersing individuals.  <a href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85">More...</a><br /></td></tr>
<tr class="separator:a404a1a676a9b88fda61c8a7f5834bf85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b35087348bc2e7161361d92b60e3c04"><td class="memTemplParams" colspan="2">template&lt;typename DispersalKernel &gt; </td></tr>
<tr class="memitem:a0b35087348bc2e7161361d92b60e3c04"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a0b35087348bc2e7161361d92b60e3c04">move_overpopulated_pests</a> (IntegerRaster &amp;susceptible, IntegerRaster &amp;infected, const IntegerRaster &amp;total_hosts, std::vector&lt; std::tuple&lt; int, int &gt;&gt; &amp;outside_dispersers, <a class="el" href="namespacepops.html#a12d03d2282e4fab7a1e0e8040a022c40">DispersalKernel</a> &amp;dispersal_kernel, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells, double overpopulation_percentage, double leaving_percentage)</td></tr>
<tr class="memdesc:a0b35087348bc2e7161361d92b60e3c04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move overflowing pest population to other hosts.  <a href="classpops_1_1Simulation.html#a0b35087348bc2e7161361d92b60e3c04">More...</a><br /></td></tr>
<tr class="separator:a0b35087348bc2e7161361d92b60e3c04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a870e5d49549e23b1446d545f2889132a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a">infect_exposed</a> (unsigned step, std::vector&lt; IntegerRaster &gt; &amp;exposed, IntegerRaster &amp;infected, IntegerRaster &amp;mortality_tracker, IntegerRaster &amp;total_exposed)</td></tr>
<tr class="memdesc:a870e5d49549e23b1446d545f2889132a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Infect exposed hosts (E to I transition in the SEI model)  <a href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a">More...</a><br /></td></tr>
<tr class="separator:a870e5d49549e23b1446d545f2889132a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae39386514d5a0849d7453b0afdf44344"><td class="memTemplParams" colspan="2">template&lt;typename DispersalKernel &gt; </td></tr>
<tr class="memitem:ae39386514d5a0849d7453b0afdf44344"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classpops_1_1Simulation.html#ae39386514d5a0849d7453b0afdf44344">disperse_and_infect</a> (unsigned step, const IntegerRaster &amp;dispersers, IntegerRaster &amp;susceptible, std::vector&lt; IntegerRaster &gt; &amp;exposed, IntegerRaster &amp;infected, IntegerRaster &amp;mortality_tracker, const IntegerRaster &amp;total_populations, IntegerRaster &amp;total_exposed, std::vector&lt; std::tuple&lt; int, int &gt;&gt; &amp;outside_dispersers, bool weather, const FloatRaster &amp;weather_coefficient, <a class="el" href="namespacepops.html#a12d03d2282e4fab7a1e0e8040a022c40">DispersalKernel</a> &amp;dispersal_kernel, const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;suitable_cells, double establishment_probability=0.5)</td></tr>
<tr class="memdesc:ae39386514d5a0849d7453b0afdf44344"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disperse, expose, and infect based on dispersers.  <a href="classpops_1_1Simulation.html#ae39386514d5a0849d7453b0afdf44344">More...</a><br /></td></tr>
<tr class="separator:ae39386514d5a0849d7453b0afdf44344"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename IntegerRaster, typename FloatRaster, typename RasterIndex = int&gt;<br />
class pops::Simulation&lt; IntegerRaster, FloatRaster, RasterIndex &gt;</h3>

<p>The main class to control the spread simulation. </p>
<p>The <a class="el" href="classpops_1_1Simulation.html" title="The main class to control the spread simulation.">Simulation</a> class handles the mechanics of the model, but the timing of the events or steps should be handled outside of this class unless noted otherwise. The notable exceptions are exposed hosts in the SEI model type and mortality.</p>
<p>The template parameters IntegerRaster and FloatRaster are raster image or matrix types. Any 2D numerical array should work as long as it uses function call operator to access the values, i.e. it provides indexing for reading and writing values using <code>()</code>. In other words, the operations such as the two following ones should be possible:</p>
<div class="fragment"><div class="line">a(i, j) = 1;</div>
<div class="line">a(i, j) == 1;</div>
</div><!-- fragment --><p>The PoPS library offers a <a class="el" href="classpops_1_1Raster.html" title="Representation of a raster image.">Raster</a> template class to fill this role, but other classes can be used as well.</p>
<p>Template parameter RasterIndex is type used for maximum indices of the used rasters and should be the same as what the actual raster types are using. However, at the same time, comparison with signed type are perfomed and a signed type might be required in the future. A default is provided, but it can be changed in the future. </p>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00126">126</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a72d91f035b337f83baad33060668503a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d91f035b337f83baad33060668503a">&#9670;&nbsp;</a></span>Simulation() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::<a class="el" href="classpops_1_1Simulation.html">Simulation</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>random_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RasterIndex&#160;</td>
          <td class="paramname"><em>rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RasterIndex&#160;</td>
          <td class="paramname"><em>cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacepops.html#adebccffc3c90801a4d306c1a43c5ac20">ModelType</a>&#160;</td>
          <td class="paramname"><em>model_type</em> = <code><a class="el" href="namespacepops.html#adebccffc3c90801a4d306c1a43c5ac20af0788f6fa2be9b0969507a4424b0c91c">ModelType::SusceptibleInfected</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>latency_period</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dispersers_stochasticity</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>establishment_stochasticity</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>movement_stochasticity</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates simulation object and seeds the internal random number generator. </p>
<p>The same random number generator is used throughout the simulation and is seeded once at the beginning.</p>
<p>The number or rows and columns needs to be the same as the size of rasters used with the <a class="el" href="classpops_1_1Simulation.html" title="The main class to control the spread simulation.">Simulation</a> object (potentially, it can be also smaller).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model_type</td><td>Type of the model (SI or SEI) </td></tr>
    <tr><td class="paramname">latency_period</td><td>Length of the latency period in steps </td></tr>
    <tr><td class="paramname">random_seed</td><td>Number to seed the random number generator </td></tr>
    <tr><td class="paramname">rows</td><td>Number of rows </td></tr>
    <tr><td class="paramname">cols</td><td>Number of columns </td></tr>
    <tr><td class="paramname">dispersers_stochasticity</td><td>Enable stochasticity in generating of dispersers </td></tr>
    <tr><td class="paramname">establishment_stochasticity</td><td>Enable stochasticity in establishment step </td></tr>
    <tr><td class="paramname">movement_stochasticity</td><td>Enable stochasticity in movement of hosts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00157">157</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>

</div>
</div>
<a id="a84bc14a9f3e393edc560e78586761e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84bc14a9f3e393edc560e78586761e23">&#9670;&nbsp;</a></span>Simulation() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::<a class="el" href="classpops_1_1Simulation.html">Simulation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a404a1a676a9b88fda61c8a7f5834bf85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404a1a676a9b88fda61c8a7f5834bf85">&#9670;&nbsp;</a></span>disperse()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<div class="memtemplate">
template&lt;typename DispersalKernel &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::disperse </td>
          <td>(</td>
          <td class="paramtype">const IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>dispersers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>susceptible</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>exposed_or_infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>mortality_tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_populations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_exposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; int, int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>outside_dispersers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>weather</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FloatRaster &amp;&#160;</td>
          <td class="paramname"><em>weather_coefficient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacepops.html#a12d03d2282e4fab7a1e0e8040a022c40">DispersalKernel</a> &amp;&#160;</td>
          <td class="paramname"><em>dispersal_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>establishment_probability</em> = <code>0.5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates dispersal locations for the dispersing individuals. </p>
<p>Depending on what data is provided as the <em>exposed_or_infected</em> parameter, this function can be part of the S to E step or the S to I step.</p>
<p>Typically, the <a class="el" href="classpops_1_1Simulation.html#a83fb3fbcb9ad981708d04e4d9ae12e7b" title="Generates dispersers based on infected.">generate()</a> function is called beforehand to create dispersers. In SEI model, the <a class="el" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a" title="Infect exposed hosts (E to I transition in the SEI model)">infect_exposed()</a> function is typically called afterwards.</p>
<p>DispersalKernel is callable object or function with one parameter which is the random number engine (generator). The return value is row and column in the raster (or outside of it). The current position is passed as parameters. The return value is in the form of a tuple with row and column so that std::tie() is usable on the result, i.e. function returning <code>std::make_tuple(row, column)</code> fulfills this requirement.</p>
<p>The <em>total_populations</em> can be total number of hosts in the basic case or it can be the total size of population of all relevant species both host and non-host if dilution effect should be applied.</p>
<p>If establishment stochasticity is disabled, <em>establishment_probability</em> is used to decide whether or not a disperser is established in a cell. Value 1 means that all dispersers will establish and value 0 means that no dispersers will establish.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dispersers</td><td>Dispersing individuals ready to be dispersed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">susceptible</td><td>Susceptible hosts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">exposed_or_infected</td><td>Exposed or infected hosts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mortality_tracker</td><td>Newly infected hosts (if applicable) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">total_exposed</td><td>Total exposed in all exposed cohorts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">total_populations</td><td>All host and non-host individuals in the area </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outside_dispersers</td><td>Dispersers escaping the raster </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">weather</td><td>Whether or not weather coefficients should be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weather_coefficient</td><td>Weather coefficient for each location </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dispersal_kernel</td><td>Dispersal kernel to move dispersers </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">establishment_probability</td><td>Probability of establishment with no stochasticity</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If the parameters or their default values don't correspond with the <a class="el" href="classpops_1_1Simulation.html#ae39386514d5a0849d7453b0afdf44344" title="Disperse, expose, and infect based on dispersers.">disperse_and_infect()</a> function, it is a bug. </dd></dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00499">499</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classpops_1_1Simulation_a404a1a676a9b88fda61c8a7f5834bf85_icgraph.png" border="0" usemap="#classpops_1_1Simulation_a404a1a676a9b88fda61c8a7f5834bf85_icgraph" alt=""/></div>
<map name="classpops_1_1Simulation_a404a1a676a9b88fda61c8a7f5834bf85_icgraph" id="classpops_1_1Simulation_a404a1a676a9b88fda61c8a7f5834bf85_icgraph">
<area shape="rect" title="Creates dispersal locations for the dispersing individuals." alt="" coords="248,13,443,39"/>
<area shape="rect" href="classpops_1_1Simulation.html#ae39386514d5a0849d7453b0afdf44344" title="Disperse, expose, and infect based on dispersers." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="ae39386514d5a0849d7453b0afdf44344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae39386514d5a0849d7453b0afdf44344">&#9670;&nbsp;</a></span>disperse_and_infect()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<div class="memtemplate">
template&lt;typename DispersalKernel &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::disperse_and_infect </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>dispersers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>susceptible</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; IntegerRaster &gt; &amp;&#160;</td>
          <td class="paramname"><em>exposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>mortality_tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_populations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_exposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; int, int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>outside_dispersers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>weather</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FloatRaster &amp;&#160;</td>
          <td class="paramname"><em>weather_coefficient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacepops.html#a12d03d2282e4fab7a1e0e8040a022c40">DispersalKernel</a> &amp;&#160;</td>
          <td class="paramname"><em>dispersal_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>establishment_probability</em> = <code>0.5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disperse, expose, and infect based on dispersers. </p>
<p>This function wraps <a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals.">disperse()</a> and <a class="el" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a" title="Infect exposed hosts (E to I transition in the SEI model)">infect_exposed()</a> for use in SI and SEI models.</p>
<p>In case of SEI model, before calling this function, last item in the exposed vector needs to be ready to be used for exposure, i.e., typically, it should be empty in the sense that there are no hosts in the raster. This is normally taken care of by a previous call to this function. The initial state of the exposed vector should be such that size is latency period in steps plus 1 and each raster is empty, i.e., does not contain any hosts (all values set to zero).</p>
<p>See the <a class="el" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a" title="Infect exposed hosts (E to I transition in the SEI model)">infect_exposed()</a> function for the details about exposed vector, its size, and its items.</p>
<p>See <a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals.">disperse()</a> and <a class="el" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a" title="Infect exposed hosts (E to I transition in the SEI model)">infect_exposed()</a> for a detailed list of parameters and behavior. The <a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals.">disperse()</a> parameter documentation can be applied as is except that <a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals.">disperse()</a> function's parameter <em>exposed_or_infested</em> is expected to change based on the context while this function's parameter <em>infected</em> is always the infected individuals. Besides parameters from <a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals.">disperse()</a>, this function has parameter <em>exposed</em> which is the same as the one from the <a class="el" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a" title="Infect exposed hosts (E to I transition in the SEI model)">infect_exposed()</a> function. </p>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00771">771</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classpops_1_1Simulation_ae39386514d5a0849d7453b0afdf44344_cgraph.png" border="0" usemap="#classpops_1_1Simulation_ae39386514d5a0849d7453b0afdf44344_cgraph" alt=""/></div>
<map name="classpops_1_1Simulation_ae39386514d5a0849d7453b0afdf44344_cgraph" id="classpops_1_1Simulation_ae39386514d5a0849d7453b0afdf44344_cgraph">
<area shape="rect" title="Disperse, expose, and infect based on dispersers." alt="" coords="5,27,200,69"/>
<area shape="rect" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals." alt="" coords="248,5,443,32"/>
<area shape="rect" href="classpops_1_1Simulation.html#a870e5d49549e23b1446d545f2889132a" title="Infect exposed hosts (E to I transition in the SEI model)" alt="" coords="257,57,433,98"/>
<area shape="rect" href="namespacepops.html#a115caa911898fbbdae3ae299d834f16d" title="Rotate elements in a container to the left by one." alt="" coords="491,64,673,91"/>
</map>
</div>

</div>
</div>
<a id="a83fb3fbcb9ad981708d04e4d9ae12e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83fb3fbcb9ad981708d04e4d9ae12e7b">&#9670;&nbsp;</a></span>generate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::generate </td>
          <td>(</td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>dispersers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>weather</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FloatRaster &amp;&#160;</td>
          <td class="paramname"><em>weather_coefficient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>reproductive_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates dispersers based on infected. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dispersers</td><td>(existing values are ignored) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">infected</td><td>Currently infected hosts </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">weather</td><td>Whether to use the weather coefficient </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">weather_coefficient</td><td>Spatially explicit weather coefficient </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">reproductive_rate</td><td>reproductive rate (used unmodified when weather coefficient is not used) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00421">421</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>

</div>
</div>
<a id="a870e5d49549e23b1446d545f2889132a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a870e5d49549e23b1446d545f2889132a">&#9670;&nbsp;</a></span>infect_exposed()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::infect_exposed </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; IntegerRaster &gt; &amp;&#160;</td>
          <td class="paramname"><em>exposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>mortality_tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_exposed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Infect exposed hosts (E to I transition in the SEI model) </p>
<p>Applicable to SEI model, no-operation otherwise, i.e., parameters are left intact for other models.</p>
<p>The exposed vector are the hosts exposed in the previous steps. The length of the vector is the number of steps of the latency period plus one. Before the first latency period is over, the E to I transition won't happen because no item in the exposed vector is old enough to become infected.</p>
<p>The position of the items in the exposed vector determines their age, i.e., for how long the hosts are exposed. The oldest item is at the front and youngest at the end. Before the the first latency period is over, items in the front are still empty (unused) because no hosts were exposed for the given time period. After the first latency period, this needs to be true before the function is called and it is true after the function finished with the difference that after the function is called, the last item is empty in the sense that it does not contain any hosts.</p>
<p>When the E to I transition happens, hosts from the oldest item in the exposed vector are moved to the infected (and mortality tracker). They are removed from the exposed item and this item is moved to the back of the vector.</p>
<p>Like in <a class="el" href="classpops_1_1Simulation.html#a404a1a676a9b88fda61c8a7f5834bf85" title="Creates dispersal locations for the dispersing individuals.">disperse()</a>, there is no distinction between <em>infected</em> and <em>mortality_tracker</em>, but different usage is expected outside of this function.</p>
<p>The raster class used with the simulation class needs to support <code>.fill()</code> method for this function to work.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">step</td><td><a class="el" href="classpops_1_1Step.html" title="Representation and manipulation of a date for the simulation.">Step</a> in the simulation (&gt;=0) </td></tr>
    <tr><td class="paramname">exposed</td><td>Vector of exposed hosts </td></tr>
    <tr><td class="paramname">infected</td><td>Infected hosts </td></tr>
    <tr><td class="paramname">mortality_tracker</td><td>Newly infected hosts </td></tr>
    <tr><td class="paramname">total_exposed</td><td>Total exposed in all exposed cohorts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00710">710</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_cgraph.png" border="0" usemap="#classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_cgraph" alt=""/></div>
<map name="classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_cgraph" id="classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_cgraph">
<area shape="rect" title="Infect exposed hosts (E to I transition in the SEI model)" alt="" coords="5,5,181,47"/>
<area shape="rect" href="namespacepops.html#a115caa911898fbbdae3ae299d834f16d" title="Rotate elements in a container to the left by one." alt="" coords="229,13,412,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_icgraph.png" border="0" usemap="#classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_icgraph" alt=""/></div>
<map name="classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_icgraph" id="classpops_1_1Simulation_a870e5d49549e23b1446d545f2889132a_icgraph">
<area shape="rect" title="Infect exposed hosts (E to I transition in the SEI model)" alt="" coords="248,5,424,47"/>
<area shape="rect" href="classpops_1_1Simulation.html#ae39386514d5a0849d7453b0afdf44344" title="Disperse, expose, and infect based on dispersers." alt="" coords="5,5,200,47"/>
</map>
</div>

</div>
</div>
<a id="a9c4f2e4d644adcae3e7aa2d5b2739367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c4f2e4d644adcae3e7aa2d5b2739367">&#9670;&nbsp;</a></span>mortality()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::mortality </td>
          <td>(</td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_hosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mortality_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mortality_time_lag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>died</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; IntegerRaster &gt; &amp;&#160;</td>
          <td class="paramname"><em>mortality_tracker_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>kills infected hosts based on mortality rate and timing. </p>
<p>In the last year of mortality tracking the first index all remaining tracked infected hosts are removed. In indexes that are in the mortality_time_lag no mortality occurs. In all other indexes the number of tracked individuals is multiplied by the mortality rate to calculate the number of hosts that die that time step. The mortality_tracker_vector has a minimum size of mortality_time_lag + 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infected</td><td>Currently infected hosts </td></tr>
    <tr><td class="paramname">total_hosts</td><td>All hosts </td></tr>
    <tr><td class="paramname">mortality_rate</td><td>percent of infected hosts that die each time period </td></tr>
    <tr><td class="paramname">mortality_time_lag</td><td>time lag prior to mortality beginning </td></tr>
    <tr><td class="paramname">died</td><td>dead hosts during time step </td></tr>
    <tr><td class="paramname">mortality_tracker_vector</td><td>vector of matrices for tracking infected host infection over time. Expectation is that mortality tracker is of length (1/mortality_rate + mortality_time_lag) </td></tr>
    <tr><td class="paramname">suitable_cells</td><td>used to run model only where host are known to occur </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00223">223</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classpops_1_1Simulation_a9c4f2e4d644adcae3e7aa2d5b2739367_cgraph.png" border="0" usemap="#classpops_1_1Simulation_a9c4f2e4d644adcae3e7aa2d5b2739367_cgraph" alt=""/></div>
<map name="classpops_1_1Simulation_a9c4f2e4d644adcae3e7aa2d5b2739367_cgraph" id="classpops_1_1Simulation_a9c4f2e4d644adcae3e7aa2d5b2739367_cgraph">
<area shape="rect" title="kills infected hosts based on mortality rate and timing." alt="" coords="5,5,204,32"/>
<area shape="rect" href="namespacepops.html#a115caa911898fbbdae3ae299d834f16d" title="Rotate elements in a container to the left by one." alt="" coords="252,5,435,32"/>
</map>
</div>

</div>
</div>
<a id="a0b35087348bc2e7161361d92b60e3c04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b35087348bc2e7161361d92b60e3c04">&#9670;&nbsp;</a></span>move_overpopulated_pests()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<div class="memtemplate">
template&lt;typename DispersalKernel &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::move_overpopulated_pests </td>
          <td>(</td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>susceptible</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_hosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::tuple&lt; int, int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>outside_dispersers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacepops.html#a12d03d2282e4fab7a1e0e8040a022c40">DispersalKernel</a> &amp;&#160;</td>
          <td class="paramname"><em>dispersal_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>overpopulation_percentage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leaving_percentage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move overflowing pest population to other hosts. </p>
<p>When the number of pests (pest population) is too high, part of them moves to a different location. Number of infected/infested hosts is considered to be the number of pests (groups of pest) in a raster cell.</p>
<p>The movement happens in two stages. First, all the leaving pests are identified and removed from the source cells. Second, the move to the target cells is performed. This means that even if the resulting number of pests in the target cell is considered too high, it is left as is and the move is performed the next time this function is called.</p>
<p>If the pests (pest population) cannot be accommodated in the target cell due to the insufficient number of susceptible hosts, the excessive pests die.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">susceptible</td><td>Susceptible hosts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">infected</td><td>Infected hosts </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">total_hosts</td><td>All host individuals in the area. Is equal to infected + exposed + susceptible in the cell. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outside_dispersers</td><td>Dispersers escaping the rasters </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dispersal_kernel</td><td>Dispersal kernel to move dispersers (pests) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">overpopulation_percentage</td><td>Percentage of occupied hosts when the cell is considered to be overpopulated </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">leaving_percentage</td><td>Percentage pests leaving an overpopulated cell</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Exposed hosts do not count towards total number of pest, i.e., <em>total_host</em> is assumed to be S + E in SEI model. </dd>
<dd>
Mortality is not supported by this function, i.e., the mortality rasters are not modified while the infected are. </dd></dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00591">591</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>

</div>
</div>
<a id="a1770a130586e638e6b2d4aa85ae0b3cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1770a130586e638e6b2d4aa85ae0b3cd">&#9670;&nbsp;</a></span>movement()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::movement </td>
          <td>(</td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>susceptible</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; IntegerRaster &gt; &amp;&#160;</td>
          <td class="paramname"><em>mortality_tracker_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; IntegerRaster &gt; &amp;&#160;</td>
          <td class="paramname"><em>exposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>resistant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_hosts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>total_exposed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>last_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>movements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned &gt;&#160;</td>
          <td class="paramname"><em>movement_schedule</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Moves hosts from one location to another. </p>
<dl class="section note"><dt>Note</dt><dd>Note that unlike the other functions, here, <em>total_hosts</em>, i.e., number of hosts is required, not number of all hosts and non-host individuals.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infected</td><td>Currently infected hosts </td></tr>
    <tr><td class="paramname">susceptible</td><td>Currently susceptible hosts </td></tr>
    <tr><td class="paramname">mortality_tracker_vector</td><td>Hosts that are infected at a specific time step </td></tr>
    <tr><td class="paramname">total_hosts</td><td>All host individuals in the area. Is equal to infected + exposed + susceptible in the cell. </td></tr>
    <tr><td class="paramname">total_exposed</td><td>Total exposed in all exposed cohorts </td></tr>
    <tr><td class="paramname">step</td><td>the current step of the simulation </td></tr>
    <tr><td class="paramname">last_index</td><td>the last index to not be used from movements </td></tr>
    <tr><td class="paramname">movements</td><td>a vector of ints with row_from, col_from, row_to, col_to, and num_hosts </td></tr>
    <tr><td class="paramname">movement_schedule</td><td>a vector matching movements with the step at which the movement from movements are applied</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Mortality and non-host individuals are not supported in movements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00286">286</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classpops_1_1Simulation_a1770a130586e638e6b2d4aa85ae0b3cd_cgraph.png" border="0" usemap="#classpops_1_1Simulation_a1770a130586e638e6b2d4aa85ae0b3cd_cgraph" alt=""/></div>
<map name="classpops_1_1Simulation_a1770a130586e638e6b2d4aa85ae0b3cd_cgraph" id="classpops_1_1Simulation_a1770a130586e638e6b2d4aa85ae0b3cd_cgraph">
<area shape="rect" title="Moves hosts from one location to another." alt="" coords="5,5,216,32"/>
<area shape="rect" href="namespacepops.html#a92b7a1aa7d16e3b395dd0f66a1f6b31c" title="Draws n elements from a vector." alt="" coords="264,5,425,32"/>
</map>
</div>

</div>
</div>
<a id="ad060e789f6c3260f4e96f9a14c0caad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad060e789f6c3260f4e96f9a14c0caad8">&#9670;&nbsp;</a></span>remove()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename IntegerRaster , typename FloatRaster , typename RasterIndex  = int&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classpops_1_1Simulation.html">pops::Simulation</a>&lt; IntegerRaster, FloatRaster, RasterIndex &gt;::remove </td>
          <td>(</td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>infected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerRaster &amp;&#160;</td>
          <td class="paramname"><em>susceptible</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FloatRaster &amp;&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lethal_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>suitable_cells</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>removes infected based on min or max temperature tolerance </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infected</td><td>Currently infected hosts </td></tr>
    <tr><td class="paramname">susceptible</td><td>Currently susceptible hosts </td></tr>
    <tr><td class="paramname">temperature</td><td>Spatially explicit temperature </td></tr>
    <tr><td class="paramname">lethal_temperature</td><td>temperature at which lethal conditions occur </td></tr>
    <tr><td class="paramname">suitable_cells</td><td>used to run model only where host are known to occur </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="simulation_8hpp_source.html#l00187">187</a> of file <a class="el" href="simulation_8hpp_source.html">simulation.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/pops/<a class="el" href="simulation_8hpp_source.html">simulation.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
